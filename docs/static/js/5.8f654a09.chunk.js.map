{"version":3,"sources":["containers/AccountManagerContainer/components/LoginArea.jsx","containers/AccountManagerContainer/components/RegisterArea.jsx","containers/AccountManagerContainer/components/LoginStatus.jsx","containers/AccountManagerContainer/index.jsx"],"names":["LoginArea","props","_React$useState","React","useState","_React$useState2","Object","slicedToArray","username","setUsername","_React$useState3","_React$useState4","password","setPassword","handleInputUsername","useCallback","evt","target","value","handleInputPassword","onLogin","isLogining","disabled","tryLogin","isDisabled","trim","buttonText","react_default","a","createElement","List","ListItem","TextField","onChange","type","label","fullWidth","TextFieldOnKeyEnterUp","onKeyEnterUp","Button","variant","onClick","defaultProps","RegisterArea","onRegister","tryRegister","placeholder","UserInfo","$userInfo","concat","get","usernamePattern","passwordPattern","AccountManagerContainer","dispatch","hasLogin","isRegistering","_useState","_useState2","tabIndex","setTabIndex","history","useHistory","_useState3","_useState4","isShow","setIsShow","handleClickMask","afterExitTransition","push","handleTabChange","tabIndexChangedTo","handleLogin","userInfo","_userInfo$username","_userInfo$password","test","userActions","effectLogin","globalActions","addOneNitification","title","detail","key","uniqueId","handleRegister","_userInfo$username2","_userInfo$password2","effectRegister","handleClickLogoutButton","logout","tabContentItems","useMemo","components_LoginArea","components_RegisterArea","Fade","in","onExited","className","style","position","display","justifyContent","alignItems","top","left","height","width","zIndex","boxSizing","padding","backgroundColor","Paper","stopEventPropagation","Fragment","LoginStatus","Tabs","indicatorColor","textColor","centered","Tab","connect","$state","getIn"],"mappings":"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","file":"static/js/5.8f654a09.chunk.js","sourcesContent":["import React, { useCallback } from 'react';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\nimport PropTypes from 'prop-types';\nimport TextFieldOnKeyEnterUp from '../../../components/TextFieldOnKeyEnterUp';\n\n\nfunction LoginArea(props) {\n  const [username, setUsername] = React.useState('');\n  const [password, setPassword] = React.useState('');\n\n  const handleInputUsername = useCallback((evt) => setUsername(evt.target.value), [setUsername]);\n  const handleInputPassword = useCallback((evt) => setPassword(evt.target.value), [setPassword]);\n\n  const { onLogin, disabled } = props;\n\n  const isLogining = disabled;\n\n  const tryLogin = useCallback(() => {\n    // handleClickButton\n    onLogin({\n      username,\n      password,\n    });\n  }, [username, password, onLogin]);\n\n  const isDisabled = isLogining || username.trim() === '' || password.trim() === '';\n\n  const buttonText = isLogining ? '登录中...' : '登录';\n\n  return (\n    <List>\n      <ListItem>\n        <TextField value={username} onChange={handleInputUsername} type=\"text\" label=\"用户名\" fullWidth />\n      </ListItem>\n      <ListItem>\n        <TextFieldOnKeyEnterUp onKeyEnterUp={tryLogin} value={password} onChange={handleInputPassword} type=\"password\" label=\"密码\" fullWidth />\n      </ListItem>\n      <ListItem>\n        <Button disabled={isDisabled} variant=\"outlined\" onClick={tryLogin} fullWidth>\n          {buttonText}\n        </Button>\n      </ListItem>\n    </List>\n  );\n}\n\nLoginArea.propTypes = {\n  onLogin: PropTypes.func.isRequired,\n  disabled: PropTypes.bool,\n};\n\nLoginArea.defaultProps = {\n  disabled: false,\n};\n\n\nexport default LoginArea;\n","import React, { useCallback } from 'react';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\nimport PropTypes from 'prop-types';\nimport TextFieldOnKeyEnterUp from '../../../components/TextFieldOnKeyEnterUp';\n\n\nfunction RegisterArea(props) {\n  const [username, setUsername] = React.useState('');\n  const [password, setPassword] = React.useState('');\n\n  const handleInputUsername = useCallback((evt) => setUsername(evt.target.value), [setUsername]);\n  const handleInputPassword = useCallback((evt) => setPassword(evt.target.value), [setPassword]);\n\n  const { onRegister, disabled } = props;\n\n  const tryRegister = useCallback(() => {\n    // handle click register button\n    onRegister({\n      username,\n      password,\n    });\n  }, [username, password, onRegister]);\n\n  const isDisabled = disabled || username.trim() === '' || password.trim() === '';\n\n  return (\n    <List>\n      <ListItem>\n        <TextField placeholder=\"请输入4到16位字母，数字\" value={username} onChange={handleInputUsername} type=\"text\" label=\"用户名\" fullWidth />\n      </ListItem>\n      <ListItem>\n        {/* 这里密码输入用type=text是为了用户视觉上可以确认所输入的密码 */}\n        <TextFieldOnKeyEnterUp onKeyEnterUp={tryRegister} placeholder=\"请输入4到16位字母，数字\" value={password} onChange={handleInputPassword} type=\"text\" label=\"密码\" fullWidth />\n      </ListItem>\n      <ListItem>\n        <Button disabled={isDisabled} variant=\"outlined\" onClick={tryRegister} fullWidth>\n          注册\n        </Button>\n      </ListItem>\n    </List>\n  );\n}\n\nRegisterArea.propTypes = {\n  onRegister: PropTypes.func.isRequired,\n  disabled: PropTypes.bool,\n};\n\nRegisterArea.defaultProps = {\n  disabled: false,\n};\n\n\nexport default RegisterArea;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Map } from 'immutable';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\n\nfunction UserInfo(props) {\n  const { $userInfo } = props;\n\n  return (\n    <List>\n      <ListItem>\n        已经登录，欢迎您!\n      </ListItem>\n      <ListItem>\n        {`用户名: ${$userInfo.get('username')}`}\n      </ListItem>\n    </List>\n  );\n}\n\nUserInfo.propTypes = {\n  $userInfo: PropTypes.instanceOf(Map).isRequired,\n};\n\nUserInfo.defaultProps = {};\n\nexport default UserInfo;\n","import React, { useState, useCallback, useMemo } from 'react';\nimport Paper from '@material-ui/core/Paper';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport { connect } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport Button from '@material-ui/core/Button';\nimport { Map } from 'immutable';\nimport Fade from '@material-ui/core/Fade';\nimport { useHistory } from 'react-router-dom';\n\n\nimport LoginArea from './components/LoginArea';\nimport RegisterArea from './components/RegisterArea';\nimport LoginStatus from './components/LoginStatus';\nimport { globalActions, userActions } from '../../store/actions';\nimport { stopEventPropagation, uniqueId } from '../../utils';\n\nconst usernamePattern = /^[a-zA-Z0-9_-]{4,16}$/;\nconst passwordPattern = /^[a-zA-Z0-9_-]{4,16}$/;\n\nfunction AccountManagerContainer(props) {\n  const {\n    dispatch,\n    hasLogin,\n    $userInfo,\n    isLogining,\n    isRegistering,\n  } = props;\n\n  const [tabIndex, setTabIndex] = useState(0);\n\n  const history = useHistory();\n\n  const [isShow, setIsShow] = useState(true);\n\n  const handleClickMask = useCallback(() => {\n    setIsShow(false);\n  }, [setIsShow]);\n\n  const afterExitTransition = useCallback(() => {\n    history.push('/');\n  }, []);\n\n  const handleTabChange = useCallback((evt, tabIndexChangedTo) => {\n    setTabIndex(tabIndexChangedTo);\n  }, []);\n\n  const handleLogin = useCallback(\n    (userInfo) => {\n      const { username = '', password = '' } = userInfo;\n      if (usernamePattern.test(username) && passwordPattern.test(password)) {\n        dispatch(userActions.effectLogin(userInfo));\n      } else {\n        dispatch(\n          globalActions.addOneNitification({\n            type: 'error',\n            title: '登录失败',\n            detail: '非法用户名或密码，请输入4到16位的字母或数字',\n            key: uniqueId('notify'),\n          }),\n        );\n      }\n    },\n    [dispatch],\n  );\n\n  const handleRegister = useCallback(\n    (userInfo) => {\n      const { username = '', password = '' } = userInfo;\n      if (usernamePattern.test(username) && passwordPattern.test(password)) {\n        dispatch(userActions.effectRegister(userInfo));\n      } else {\n        dispatch(\n          globalActions.addOneNitification({\n            type: 'error',\n            title: '注册失败',\n            detail: '非法用户名或密码，请输入4到16位的字母或数字',\n            key: uniqueId('notify'),\n          }),\n        );\n      }\n    },\n    [dispatch],\n  );\n\n  const handleClickLogoutButton = useCallback(() => {\n    dispatch(userActions.logout());\n  }, [dispatch]);\n\n  const loginArea = useMemo(\n    () => <LoginArea disabled={isLogining} onLogin={handleLogin} />,\n    [isLogining, handleLogin],\n  );\n  const registerArea = useMemo(\n    () => <RegisterArea disabled={isRegistering} onRegister={handleRegister} />,\n    [handleRegister, isRegistering],\n  );\n\n  const tabContentItems = [loginArea, registerArea];\n\n  return (\n    <Fade in={isShow} onExited={afterExitTransition}>\n      <div\n        className=\"AccountManager\"\n        onClick={handleClickMask}\n        style={{\n          position: 'absolute',\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          top: '0',\n          left: '0',\n          height: '100%',\n          width: '100%',\n          zIndex: '3000',\n          boxSizing: 'border-box',\n          padding: '0 50px',\n          backgroundColor: 'rgba(0, 0, 0, 0.25)',\n        }}\n      >\n        <Paper onClick={stopEventPropagation}>\n          {hasLogin ? (\n            <>\n              <LoginStatus $userInfo={$userInfo} />\n              <Button\n                fullWidth\n                variant=\"outlined\"\n                onClick={handleClickLogoutButton}\n              >\n                退出\n              </Button>\n            </>\n          ) : (\n            <>\n              <Tabs\n                value={tabIndex}\n                indicatorColor=\"primary\"\n                textColor=\"primary\"\n                onChange={handleTabChange}\n                centered\n              >\n                <Tab label=\"登录\" />\n                <Tab label=\"注册\" />\n              </Tabs>\n              <div>{tabContentItems[tabIndex]}</div>\n            </>\n          )}\n        </Paper>\n      </div>\n    </Fade>\n  );\n}\n\nAccountManagerContainer.propTypes = {\n  dispatch: PropTypes.func.isRequired,\n  isLogining: PropTypes.bool.isRequired,\n  isRegistering: PropTypes.bool.isRequired,\n  hasLogin: PropTypes.bool.isRequired,\n  $userInfo: PropTypes.instanceOf(Map),\n};\n\nAccountManagerContainer.defaultProps = {\n  $userInfo: null,\n};\n\nconst mapState = ($state) => ({\n  hasLogin: $state.getIn(['user', 'hasLogin']),\n  isLogining: $state.getIn(['user', 'isLogining']),\n  isRegistering: $state.getIn(['user', 'isRegistering']),\n  $userInfo: $state.getIn(['user', 'userInfo']),\n});\n\nexport default connect(\n  mapState,\n  null,\n)(AccountManagerContainer);\n"],"sourceRoot":""}